# 武汉麻将 - 网页版

一个基于原生 JavaScript 和 Canvas 的自创武汉麻将游戏，目前仅支持单人对战 3 个 AI 玩家。

## 游戏特色

### 🎯 正宗武汉麻将规则

- **牌型**: 万、条、筒（1-9）+ 字牌（东南西北中发白）
- **癞子系统**: 翻牌确定癞子，支持复杂的癞子使用规则
- **红中杠牌**: 红中天生为杠牌，可翻倍得分
- **吃碰限制**: 未吃碰可任意使用癞子，已吃碰最多用 1 张癞子

### 🎮 游戏功能

- **智能 AI**: 3 个电脑玩家自动对战
- **完整 UI**: Canvas 绘制的精美界面
- **实时显示**: 所有玩家的手牌、打牌历史、癞子信息
- **操作便捷**: 支持点击选牌+按钮出牌，或双击出牌

## 武汉麻将规则详解

### 基本规则

1. **牌数**: 136 张牌（无花牌和空白牌）
2. **玩家**: 4 人游戏
3. **手牌**: 每人 13 张，庄家开局额外摸 1 张（14 张）

### 癞子规则

1. **翻牌确定**: 所有玩家拿完牌后，庄家翻开牌堆第一张牌
2. **癞子确定**: 翻开牌的下一张为癞子（按顺序循环）
   - 数字牌: 1→2→3...→9→1
   - 字牌: 东 → 南 → 西 → 北 → 中 → 发 → 白 → 东
3. **使用限制**:
   - **未吃碰过**: 可使用任意数量的癞子
   - **已吃碰过**: 最多只能使用 1 张癞子
   - **多余癞子**: 必须杠出来翻倍（如果不能当普通牌使用）

### 红中特殊规则

- **天生杠牌**: 红中本身就是杠牌，有翻倍效果
- **双重身份**: 如果红中也是癞子，既可当癞子用，也可杠牌翻倍
- **策略选择**: 玩家需要在使用癞子和杠牌翻倍之间做选择

### 胡牌规则

- **基本牌型**: 4 个面子 + 1 个对子（14 张牌）
- **面子类型**:
  - 刻子（三张相同牌）
  - 顺子（三张连续数字牌，仅限万条筒）
- **癞子胡牌**: 癞子可替代任意牌组成面子和对子

## 技术实现

### 项目结构

```
├── index.html          # 游戏主页面
├── css/
│   └── style.css       # 游戏样式
├── js/
│   ├── card.js         # 牌类定义和基础操作
│   ├── deck.js         # 牌堆管理和洗牌逻辑
│   ├── player.js       # 玩家类和操作逻辑
│   ├── laizi.js        # 癞子管理和使用规则
│   ├── game.js         # 游戏主逻辑和状态管理
│   └── main.js         # UI控制器和Canvas绘制
└── README.md           # 项目说明文档
```

### 核心技术

- **原生 JavaScript**: 无第三方依赖，纯原生实现
- **Canvas 2D API**: 高性能图形渲染
- **面向对象设计**: 模块化架构，易于维护和扩展
- **状态机模式**: 清晰的游戏状态管理

### 关键算法

1. **胡牌判断**: 使用递归回溯算法检查所有可能的牌型组合
2. **癞子优化**: 智能计算最佳癞子使用方案
3. **AI 决策**: 基于概率的简单 AI 出牌策略

## 游戏界面

### 布局说明

- **中央牌桌**: 绿色牌桌背景
- **玩家手牌**: 底部显示，可点击选择
- **AI 手牌**: 三个方向显示牌背
- **打牌区域**: 四个区域分别显示各玩家的打牌历史
- **癞子信息**: 左上角显示翻牌和癞子
- **游戏信息**: 右上角显示剩余牌数等信息
- **操作按钮**: 底部控制面板

### 操作说明

1. **开始游戏**: 点击"开始游戏"按钮
2. **选择牌**: 点击手牌选择要打出的牌
3. **出牌**:
   - 方法 1: 选中牌后点击"出牌"按钮
   - 方法 2: 双击同一张牌直接打出
4. **响应操作**: 当其他玩家出牌时，可选择吃、碰、杠、胡

## 安装和运行

### 环境要求

- 现代浏览器（支持 Canvas 2D API）
- 无需安装任何软件或插件

### 运行方法

1. **直接打开**: 双击 `index.html` 文件
2. **本地服务器**:
   ```bash
   # 使用Python启动本地服务器
   python -m http.server 8000
   # 或使用Node.js
   npx http-server
   ```
3. **在线部署**: 上传到任意 Web 服务器

## 开发调试

### 调试模式

打开浏览器开发者工具（F12），在控制台可以看到详细的游戏日志：

- 玩家回合切换
- 出牌和摸牌过程
- AI 决策过程
- 胡牌判断详情
- 错误信息和警告

### 常见问题

1. **AI 不出牌**: 检查控制台是否有错误信息
2. **界面显示异常**: 确认浏览器支持 Canvas 2D API
3. **操作无响应**: 查看控制台错误日志

## 游戏截图

游戏包含以下视觉元素：

- 🀄 精美的麻将牌设计
- 🎯 直观的癞子标识
- ⚡ 实时高亮最新出牌
- 📊 完整的游戏信息显示

## 未来规划

### 待实现功能

- [ ] 网络多人游戏
- [ ] 更智能的 AI 算法
- [ ] 音效和动画效果
- [ ] 游戏统计和记录
- [ ] 自定义规则设置
- [ ] 移动端适配

### 优化方向

- [ ] 性能优化
- [ ] 代码重构
- [ ] 用户界面改进
- [ ] 更多麻将变种支持

## 贡献指南

欢迎提交 Issue 和 Pull Request！

### 开发环境搭建

1. Clone 项目
2. 在浏览器中打开`index.html`
3. 开始开发和调试

### 代码规范

- 使用 ES6+语法
- 遵循面向对象设计原则
- 添加适当的注释
- 保持代码简洁清晰

## 许可证

MIT License

## 联系方式

如有问题或建议，请通过以下方式联系：

- 提交 GitHub Issue
- 发送邮件反馈

---

**享受武汉麻将的乐趣！** 🀄🎮
